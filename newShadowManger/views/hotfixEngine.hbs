<!-- body -->
<div class='container'>

    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">

                <div class="modal-body">
                    <form id="create_patch_form" action="/singleUpload" method="post"
                          enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="description" class="form-control-label">补丁描述:</label>
                            <input type="text" class="form-control" id="description" name="description"
                                   maxlength="32"
                                   placeholder="">
                        </div>

                        <div class="form-group">
                            <label for="patch_file" class="form-control-label">补丁文件:</label>
                            <input type="file" class="form-control" id="patch_file" name="file">
                        </div>

                        <p class="text-center"><font color="#dc143c" id="err_msg"></font></p>
                        <input type="hidden" name="patch_type" value="4"/>

                    </form>
                </div>


                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="create_patch">创建</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                </div>
            </div>
        </div>
    </div>

    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">hotfix</h4>
        </div>
        <div class="Login-box">
            <h5 style="margin-left: 20px">此功能主要用于应对运营活动,当运营有新的活动需要与app交互的时候, app通过此功能来完成; 进行全量更新哦</h5>
        </div>

        <div class="container-fluid">

            <!-- Page Heading -->
            <div class="row">
                <div class="col-lg-12">
                    <p>
                        <button type="button" class="btn btn-info btn-sm" data-toggle="modal"
                                data-target="#exampleModal" data-whatever="@getbootstrap">上传补丁
                        </button>
                    </p>

                </div>
            </div>
        </div>
    </div>

    <!--<div>-->

    <!--&lt;!&ndash;<div class="panel-body ">&ndash;&gt;-->
    <!--&lt;!&ndash;<div class="col-lg-4 col-lg-offset-4" style="margin-top: 20px">&ndash;&gt;-->
    <!--&lt;!&ndash;<button class="uploadHotFixConfirm btn btn-lg btn-primary btn-block" type="submit">发布</button>&ndash;&gt;-->
    <!--&lt;!&ndash;</div>&ndash;&gt;-->
    <!--&lt;!&ndash;</div>&ndash;&gt;-->
    <!--</div>-->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <!-- <script src="http://v3.bootcss.com/assets/js/docs.min.js"></script> -->


    <!-- Bootstrap Core CSS -->
    <link href="../public/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../public/css//sb-admin.css')" rel="stylesheet">


    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="http://bootboxjs.com/bootbox.js"></script>


    <script type="text/javascript">
        $(document).ready(function () {

            $(".uploadHotFixConfirm").click(function () {
                bootbox.confirm({
                    message: "确定这个补丁吗?",
                    buttons: {
                        confirm: {
                            label: 'Yes',
                            className: 'btn-success'
                        },
                        cancel: {
                            label: 'No',
                            className: 'btn-danger'
                        }
                    },
                    callback: function (result) {
                        if (!result) {
                            return;
                        }

                    },
                });

            });


            $("#create_patch").click(function () {
                if ($("#description").val().length == 0) {
                    $("#err_msg").text('请输入补丁描述');
                    return
                }
                if ($("#patch_file").val().length == 0) {
                    $("#err_msg").text('请选择补丁文件');
                    return
                }

                if (!$("#patch_file").val().endsWith('.apk') && !$("#patch_file").val().endsWith('.jar') && !$("#patch_file").val().endsWith('.zip') && !$("#patch_file").val().endsWith('.dex')) {
                    $("#err_msg").text('补丁文件的名字必须以.apk .jar .zip .dex结尾');
                    $("#patch_file").val('');
                    return;
                }
                $("#err_msg").text('');

                var dialog = bootbox.dialog({
                    message: '<p><i class="fa fa-spin fa-spinner"></i> 正在处理...</p>'
                });
                dialog.init(function () {
                    setTimeout(function () {
                        window.location.href = window.location.href;
                    }, 5000);
                });
                $("#create_patch_form").submit();
            });
        });

    </script>
    <!-- footer -->
    <div class="footer">
        <p style="margin-left: 20px">© Company 2016</p>
    </div>
</div>
</div>